# this file is for uploading and sorting data --- WARNING: All graphs are pretty limited, will become more important as more data is introduced (@ the weekend)

'''
data will be assessed for cause of death, number of deaths, and sex of the deceased.
we will be investigating whether sex makes an individual more prone to a certain ailment or disease
if sex does affect how prone a person is, we also want to identify which sex contributes to that vulnerability
++ this is over the years / over the months, so take it with a grain of salt- we're going to be looking at overall trends
so mostly percents of deaths in populations/overwhelmingly high-density causes
'''

# imports woo
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# snatch files (adjusted because wow those other ones were illegible -  might grab more later)
ahdata = pd.read_csv("C:/Python/pyb_data/AH_Monthly_Provisional_Counts_of_Deaths_for_Select_Causes_of_Death_by_Sex__Age__and_Race_and_Hispanic_Origin.csv", delimiter = ",")
nydata = pd.read_csv("C:/Python/pyb_data/New_York_City_Leading_Causes_of_Death.csv", delimiter = ",")

# AHDATA
# get sums of total deaths (by sex) of ahdata
ahFAC = pd.to_numeric(ahdata.query("Sex == 'F'")["AllCause"]).sum()
ahMAC = pd.to_numeric(ahdata.query("Sex == 'M'")["AllCause"]).sum()

# check if it worked - success (uncommented for review)
print(ahFAC)
print(ahMAC)

# list it
ahACbySex = {"Female":ahFAC, "Male":ahMAC}
ahTAC = list(ahACbySex.values())
ahS = list(ahACbySex.keys())

# neat now barchart that
# i'm commenting this out before because i dont want to see this load every time i run the code (uncommented for review)


fig = plt.figure(figsize = (10, 5))
plt.bar(ahS, ahTAC, color='blue', width=0.4)
plt.xlabel("Sex")
plt.ylabel("Number of Fatalities in Millions (All Causes)")
plt.title("Number of Deaths by Sex (All Causes) - AH")
plt.show()


''' This dataset has more logs for Males than Females, so we're going to be treating it as percents for general distributions
as in "x% of females and y% of males represented by this dataset died of the plague" for each of the data sets
"so we can conclude that <insert sex here> are on average z-times more likely to die of the plague"
^ an example (the plague isn't actually represented here + we're doing it by zone/type of affliction) 
'''

'''
we're going to do the same thing but with respiratory afflictions
that's p, q, r on excel, or 15-17 with indexing
includes influenza + pneumonia + chronic lower respiratory diseases
and other respiratory diseases
individual listed ailments first though
'''

# First: Influenza + pneumonia (column 16, indexed as 15)
ahFIP = pd.to_numeric(ahdata.query("Sex == 'F'")["Influenza and pneumonia (J09-J18)"]).sum()
ahMIP = pd.to_numeric(ahdata.query("Sex == 'M'")["Influenza and pneumonia (J09-J18)"]).sum()

#checking to see if it works - success (uncommented for review)
print(ahFIP)
print(ahMIP)

# make it a set for the graph
ahIPbySex = {"Female": ahFIP, "Male": ahMIP}
ahIP = list(ahIPbySex.values())
ahSIP = list(ahIPbySex.keys())

# get percents of total deaths due to influenza or pneumonia for comparison (uncommented prints for review)
print(ahFIP/ahFAC)
# = 0.01820240975371677 = ~ 1.82% of all female deaths in AHdata were influenza or pneumonia
print(ahMIP/ahMAC)
# = 0.01672162961756643 = ~ 1.67% of all male deaths in AHdata were influenza or pneumonia

# now for % of IP total that were female, male (uncommented prints for review)
ahIPT = (ahFIP + ahMIP)
print(ahIPT)
# = total I+P = 49782

print(ahFIP/ahIPT)
# = 0.5049817203005103  = ~ 50.50% of influenza + pneumonia deaths were female
print(ahMIP/ahIPT)
# = 0.49501827969948975 = ~ 49.50% of influenza + pneumonia deaths were female

'''
out of the total death count on behalf of influenza and pneumonia, according to AHdata, females are ~1% more likely to 
die of their ailment. Out of the total death count, ~0.15% more females died of I + P than males, suggesting that 
females are slightly more prone to fatalities on behalf of I + P, as well as that females are slightly more prone to fatality
on behalf of of a respiratory disease. 
(Short version: 1% greater female mortality == 0.15% logged female population death uptick 
compared to total male stats; more females are likely to die of I + P than males, females are more likely to die if 
they contract I + P) 
'''

# bar plots woo + commenting it out because i don't want to see it right now (uncommented for review)

fig = plt.figure(figsize = (10, 5))
plt.bar(ahSIP, ahIP, color='#54EA9F', width=0.4)
# respiratory diseases are shades of green now
# the colour of phlegm
plt.xlabel("Sex")
plt.ylabel("Number of Fatalities in Ten Thousands (Influenza and Pneumonia)")
plt.title("Number of Deaths by Sex (Influenza and Pneumonia) - AH")
plt.show()


# now it's time to do that all over again for chronic lower respiratory disease
ahFCLRD = pd.to_numeric(ahdata.query("Sex == 'F'")["Chronic lower respiratory diseases (J40-J47)"]).sum()
ahMCLRD = pd.to_numeric(ahdata.query("Sex == 'M'")["Chronic lower respiratory diseases (J40-J47)"]).sum()
# checking to see if it works - success (uncommented for review)
print(ahFCLRD)
print(ahMCLRD)

# cool now percents out of total female, male populations and compare to percents of total CLRD population (uncommented prints for review)
print(ahFCLRD/ahFAC)
# = 0.06028322318615585  = ~ 6.03% of total female deaths in AHdata were CLRD
print(ahMCLRD/ahMAC)
# = 0.05002208622925303  = ~ 5.00% of total male deaths in AHdata were CLRD

ahCLRDT = (ahFCLRD + ahMCLRD)  # (uncommented prints for review)
print(ahCLRDT)
# = total CLRD (156974)

print(ahFCLRD/ahCLRDT)  # (uncommented prints for review)
# = 0.5303617159529603  = ~ 53.04% of CLRDT deaths were female
print(ahMCLRD/ahCLRDT)
# = 0.4696382840470396  = ~ 46.96% of CLRDT deaths were male

# woo more plotting (uncommented for review)
ahCLRDbySex = {"Female": ahFCLRD, "Male": ahMCLRD}
ahCLRD = list(ahCLRDbySex.values())
ahSCLRD = list(ahCLRDbySex.keys())

fig = plt.figure(figsize = (10, 5))
plt.bar(ahSCLRD, ahCLRD, color='#2A9E64', width=0.4)
# respiratory diseases are green now
# the colour of phlegm
plt.xlabel("Sex")
plt.ylabel("Number of Fatalities in Ten Thousands (Chronic Lower Respiratory Disease)")
plt.title("Number of Deaths by Sex (Chronic Lower Respiratory Disease) - AH")
plt.show()



# NYDATA
#right so I'm going to cut that bit short because i want to compare it to the other data set(s)

'''
this is going to be for the NYC data set- again percentages so i can compare influenza/pneumonia rates
if they dont have both to compare to i'm just maxing out the respiratory disease column and comparing totals
'''

'''
nevermind im impatient and this is taking forever to load -- ( commented out for lack of effect )
nyFAC = pd.to_numeric(nydata.query("Sex == 'F'")["Deaths"]).sum()
nyMAC = pd.to_numeric(nydata.query("Sex == 'M'")["Deaths"]).sum()
print(nyFAC)
print(nyMAC)
'''

